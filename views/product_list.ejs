<%- include header%>
<nav class="navbar navbar-inverse">
    <div class="container">
        <ul class="nav navbar-nav ">
            <li><a href="#">Let`s Go</a></li>
            <li><a href="/">主页</a></li>
            <li class="active"><a href="/product_list">商品列表</a></li>
        </ul>
        <ul class="nav navbar-nav" style="float: right">
            <li>
                <a href="/cart"><span id="cart_count" class="glyphicon glyphicon-shopping-cart">购物车(<%=cart_count%>)</span></a>
            </li>
        </ul>

    </div>
</nav>
<div class="panel panel-default" style="width: 80%;margin-left: 10%">
    <div class="panel-heading"><h4 class="text-center">商品列表</h4></div>
    <div class="panel-body">
        <table class="table table-bordered text-center">
            <thead>
            <td>分类</td>
            <td>名称</td>
            <td>单价（元）</td>
            <td>单位</td>
            <td></td>
            </thead>
            <% products.forEach(function (product) {
               if(product.barcode=='ITEM000000'||product.barcode=='ITEM000001'){product.class='饮料';}
               if(product.barcode=='ITEM000002'||product.barcode=='ITEM000003'){product.class='水果';}
                if(product.barcode=='ITEM000004'){product.class='生活用品';}
                if(product.barcode=='ITEM000005'){product.class='食品';}
            })%>
            <% products.forEach(function(product,index) {%>
            <tr>
                <td><%=product.class%></td>
                <td><%=product.name%></td>
                <td><%=product.price%></td>
                <td><%=product.unit%></td>
                <td><a class="btn btn-primary"  onclick="add_product_to_cart('<%= product.barcode%>');">加入购物车</a></td>
            </tr>
            <% })%>
        </table>
    </div>
</div>
<script type="application/javascript">
    function add_product_to_cart(barcode) {
        $.get('/add_to_cart/'+barcode+'', function (data) {
            document.getElementById('cart_count').innerText='购物车('+data.cart_count+')';
        });
    };
</script>
<%- include footer%>